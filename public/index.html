<!DOCTYPE html>
<html>
 <head>
 <meta charset="utf-8">
 <title></title>
 </head>
 
 <body>
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.8/p5.min.js"></script>
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.8/addons/p5.dom.js"></script>
  <script>
    var servoH;     // variable for the text div you'll create
    var servoG;
    var servoF; 
    var errorMsg;
    var socket = new WebSocket("ws://localhost:8081");
 
function setup() {
  socket.onopen = openSocket;
  socket.onmessage = showData;
  socket.onclose = function(){stopTimer()}
 
  // make a new div and position it at 10, 10:
  servoH = createDiv("Servo H reading reading:");
  servoH.position(10,10);
  
  servoG = createDiv("Servo G reading reading:");
  servoG.position(10,30);
  
  servoF = createDiv("Servo F reading reading:");
  servoF.position(10,50);
  
  errorMsg = createDiv('');
  errorMsg.position(10, 70);
}
    

function draw() {
}
  function openSocket() {
    servoH.html("Socket open");
    socket.send("Hello server");
  }
 
function showData(result) {
    // when the server returns, show the result in the div:
    var message = JSON.parse(result.data);
    switch(message.servo){
      case 0 : 
        servoH.html("Servo H reading: " + message.reading);
        servoH.position(message.reading + 10,10);
        break;
      case 1 :
        servoG.html("Servo G reading: " + message.reading);
        servoG.position(message.reading + 10,30);
        break;
      case 2 : 
        servoF.html("Servo F reading: " + message.reading);
        servoF.position(message.reading + 10,50);
        break;
      default : 
        error.html('Something went wrong when identifying servo.');
        break;
    }
  }
    
    var timerKey = setInterval(function(){socket.send('query');},1000);
    function stopTimer(){clearInterval(timerKey);}
</script>
 </body>

</html>